---
title: Git å›¢é˜Ÿå¼€å‘è§„èŒƒ
date: 2024-12-24
author: Lumina Team
tags:
  - git
  - è§„èŒƒ
  - å›¢é˜Ÿåä½œ
---

# Git å›¢é˜Ÿå¼€å‘è§„èŒƒ

æœ¬æ–‡æ¡£å®šä¹‰äº†é¡¹ç›®çš„ Git å·¥ä½œæµç¨‹å’Œæäº¤è§„èŒƒï¼Œæ—¨åœ¨ä¿æŒä»£ç åº“çš„æ•´æ´å’Œå¯è¿½æº¯æ€§ã€‚

## åˆ†æ”¯ç­–ç•¥

æˆ‘ä»¬é‡‡ç”¨ç®€åŒ–ç‰ˆ **GitHub Flow** å·¥ä½œæµï¼š

```mermaid
gitGraph
    commit id: "v1.0.0"
    branch feature/new-component
    commit id: "feat: ç»„ä»¶å¼€å‘"
    commit id: "fix: ä¿®å¤é—®é¢˜"
    checkout main
    merge feature/new-component tag: "v1.1.0"
    branch fix/bug-123
    commit id: "fix: ä¿®å¤Bug"
    checkout main
    merge fix/bug-123
```

### åˆ†æ”¯å‘½åè§„èŒƒ

| åˆ†æ”¯ç±»å‹ | å‘½åæ ¼å¼          | ç¤ºä¾‹                    | è¯´æ˜                 |
| -------- | ----------------- | ----------------------- | -------------------- |
| ä¸»åˆ†æ”¯   | `main`            | `main`                  | ç”Ÿäº§å°±ç»ªä»£ç ï¼Œå—ä¿æŠ¤ |
| åŠŸèƒ½åˆ†æ”¯ | `feature/<æè¿°>`  | `feature/image-preview` | æ–°åŠŸèƒ½å¼€å‘           |
| ä¿®å¤åˆ†æ”¯ | `fix/<æè¿°>`      | `fix/router-encoding`   | Bug ä¿®å¤             |
| çƒ­ä¿®å¤   | `hotfix/<æè¿°>`   | `hotfix/security-patch` | ç´§æ€¥çº¿ä¸Šä¿®å¤         |
| é‡æ„åˆ†æ”¯ | `refactor/<æè¿°>` | `refactor/api-layer`    | ä»£ç é‡æ„             |

### åˆ†æ”¯ä½¿ç”¨æŒ‡å—

#### ä»€ä¹ˆæ—¶å€™åˆ›å»ºåˆ†æ”¯ï¼Ÿ

| åœºæ™¯                         | å»ºè®®                  |
| ---------------------------- | --------------------- |
| å¤§åŠŸèƒ½ï¼ˆéœ€è¦å¤šå¤©ã€å¤šæ¬¡æäº¤ï¼‰ | âœ… å¿…é¡»åˆ›å»ºåŠŸèƒ½åˆ†æ”¯   |
| ä¸­ç­‰åŠŸèƒ½ï¼ˆ1-2ä¸ªæäº¤ï¼‰        | âš¡ å¯ç›´æ¥åœ¨ main æäº¤ |
| å°ä¿®å¤ï¼ˆæ”¹æ–‡æ¡ˆã€è°ƒæ ·å¼ï¼‰     | âš¡ ç›´æ¥åœ¨ main æäº¤   |
| å®éªŒæ€§æ”¹åŠ¨                   | âœ… åˆ›å»ºç‹¬ç«‹åˆ†æ”¯       |

#### åˆ†æ”¯å·¥ä½œæµç¨‹

```bash
# 1. ä» main åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout main
git pull origin main
git checkout -b feature/comment-system

# 2. å¼€å‘è¿‡ç¨‹ä¸­å®šæœŸæäº¤
git add .
git commit -m "feat(comments): æ·»åŠ è¯„è®ºæ•°æ®ç»“æ„"

# 3. å¼€å‘å®Œæˆåæ¨é€
git push origin feature/comment-system

# 4. åˆ›å»º Pull Request å¹¶åˆå¹¶

# 5. åˆå¹¶ååˆ é™¤æœ¬åœ°åˆ†æ”¯
git checkout main
git pull origin main
git branch -d feature/comment-system
```

## Commit ä¿¡æ¯è§„èŒƒ

æˆ‘ä»¬éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒã€‚

### æäº¤æ ¼å¼

```
<type>(<scope>): <subject>

<body>

<footer>
```

**ç¤ºä¾‹ï¼š**

```
feat(archive): æ·»åŠ å‹ç¼©åŒ…é¢„è§ˆç»„ä»¶

- æ”¯æŒ zip/rar/7z æ ¼å¼
- æ·»åŠ æ–‡ä»¶æ ‘å½¢ç»“æ„å±•ç¤º
- é›†æˆä¸‹è½½åŠŸèƒ½

Closes #123
```

### Type ç±»å‹

| ç±»å‹       | è¯´æ˜                     | ç¤ºä¾‹                      |
| ---------- | ------------------------ | ------------------------- |
| `feat`     | æ–°åŠŸèƒ½                   | `feat: æ·»åŠ å›¾ç‰‡é¢„è§ˆ`      |
| `fix`      | Bug ä¿®å¤                 | `fix: ä¿®å¤è·¯ç”±åˆ·æ–°ç™½å±`   |
| `docs`     | æ–‡æ¡£å˜æ›´                 | `docs: æ›´æ–° README`       |
| `style`    | ä»£ç æ ¼å¼ï¼ˆä¸å½±å“é€»è¾‘ï¼‰   | `style: æ ¼å¼åŒ–ä»£ç `       |
| `refactor` | é‡æ„ï¼ˆä¸æ˜¯æ–°åŠŸèƒ½æˆ–ä¿®å¤ï¼‰ | `refactor: ä¼˜åŒ–ç»„ä»¶ç»“æ„`  |
| `perf`     | æ€§èƒ½ä¼˜åŒ–                 | `perf: ä¼˜åŒ–å›¾ç‰‡åŠ è½½é€Ÿåº¦`  |
| `test`     | æµ‹è¯•ç›¸å…³                 | `test: æ·»åŠ å•å…ƒæµ‹è¯•`      |
| `build`    | æ„å»º/ä¾èµ–å˜æ›´            | `build: å‡çº§ vite ç‰ˆæœ¬`   |
| `ci`       | CI é…ç½®                  | `ci: æ·»åŠ  GitHub Actions` |
| `chore`    | å…¶ä»–æ‚é¡¹                 | `chore: æ›´æ–° .gitignore`  |
| `revert`   | å›æ»š                     | `revert: å›æ»š xxx æäº¤`   |

### Scope ä½œç”¨åŸŸï¼ˆæ¨èï¼‰

æ ¹æ®é¡¹ç›®ç»“æ„å®šä¹‰çš„ä½œç”¨åŸŸï¼š

| Scope        | è¯´æ˜     |
| ------------ | -------- |
| `components` | é€šç”¨ç»„ä»¶ |
| `layout`     | å¸ƒå±€ç›¸å…³ |
| `router`     | è·¯ç”±ç›¸å…³ |
| `styles`     | æ ·å¼ç›¸å…³ |
| `docs`       | æ–‡æ¡£å†…å®¹ |
| `utils`      | å·¥å…·å‡½æ•° |
| `deps`       | ä¾èµ–æ›´æ–° |

**å¸¦ scope çš„ç¤ºä¾‹ï¼š**

```bash
feat(components): æ·»åŠ  ImageViewer ç»„ä»¶
fix(router): ä¿®å¤ä¸­æ–‡è·¯å¾„ç¼–ç é—®é¢˜
style(layout): è°ƒæ•´ä¾§è¾¹æ é—´è·
```

### ä½¿ç”¨ Commitizen æäº¤

é¡¹ç›®å·²é…ç½® Commitizenï¼Œæ¨èä½¿ç”¨äº¤äº’å¼æäº¤ï¼š

```bash
npm run commit
```

## Pull Request è§„èŒƒ

### PR æ ‡é¢˜

éµå¾ª Commit è§„èŒƒæ ¼å¼ï¼š

```
feat(comments): æ·»åŠ æ®µè½çº§è¯„è®ºåŠŸèƒ½
```

### PR æè¿°æ¨¡æ¿

```markdown
## å˜æ›´è¯´æ˜

ç®€è¦æè¿°è¿™ä¸ª PR åšäº†ä»€ä¹ˆ

## å˜æ›´ç±»å‹

- [ ] æ–°åŠŸèƒ½ (feat)
- [ ] Bug ä¿®å¤ (fix)
- [ ] é‡æ„ (refactor)
- [ ] æ–‡æ¡£ (docs)
- [ ] å…¶ä»–

## æµ‹è¯•

- [ ] æœ¬åœ°æµ‹è¯•é€šè¿‡
- [ ] æ–°å¢/æ›´æ–°æµ‹è¯•ç”¨ä¾‹

## æˆªå›¾ï¼ˆå¦‚æœ‰ UI å˜æ›´ï¼‰
```

### Code Review è¦ç‚¹

- ä»£ç æ˜¯å¦ç¬¦åˆé¡¹ç›®è§„èŒƒ
- é€»è¾‘æ˜¯å¦æ­£ç¡®ã€æ¸…æ™°
- æ˜¯å¦æœ‰æ½œåœ¨çš„æ€§èƒ½é—®é¢˜
- æ˜¯å¦æœ‰è¶³å¤Ÿçš„é”™è¯¯å¤„ç†
- å‘½åæ˜¯å¦æ¸…æ™°ã€ä¸€è‡´

## Git é…ç½®

### å¿…è¦çš„é…ç½®æ–‡ä»¶

#### `.gitattributes`

```bash
# ç»Ÿä¸€æ¢è¡Œç¬¦
* text=auto eol=lf
*.{cmd,[cC][mM][dD]} text eol=crlf
*.{bat,[bB][aA][tT]} text eol=crlf

# äºŒè¿›åˆ¶æ–‡ä»¶
*.png binary
*.jpg binary
*.woff2 binary
```

#### `.gitignore`

ç¡®ä¿å¿½ç•¥ä»¥ä¸‹å†…å®¹ï¼š

- `node_modules/`
- `dist/`
- `.env.local`
- IDE é…ç½®æ–‡ä»¶
- ç³»ç»Ÿæ–‡ä»¶ï¼ˆ`.DS_Store`, `Thumbs.db`ï¼‰

### Git Hooks

é¡¹ç›®ä½¿ç”¨ Husky ç®¡ç† Git Hooksï¼š

| Hook         | ä½œç”¨                           |
| ------------ | ------------------------------ |
| `pre-commit` | è¿è¡Œ lint-staged æ£€æŸ¥ä»£ç æ ¼å¼  |
| `commit-msg` | æ ¡éªŒ commit ä¿¡æ¯æ ¼å¼ï¼ˆéœ€é…ç½®ï¼‰ |

## å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# æŸ¥çœ‹æäº¤å†å²
git log --oneline -20

# æŸ¥çœ‹åˆ†æ”¯
git branch -a

# åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯
git checkout -b feature/xxx

# åˆå¹¶åˆ†æ”¯
git merge feature/xxx

# åˆ é™¤æœ¬åœ°åˆ†æ”¯
git branch -d feature/xxx

# åˆ é™¤è¿œç¨‹åˆ†æ”¯
git push origin --delete feature/xxx

# æš‚å­˜å½“å‰æ”¹åŠ¨
git stash

# æ¢å¤æš‚å­˜
git stash pop

# ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤
git commit --amend

# äº¤äº’å¼å˜åŸºï¼ˆæ•´ç†æäº¤å†å²ï¼‰
git rebase -i HEAD~3
```

## ç‰ˆæœ¬å‘å¸ƒ

### ç‰ˆæœ¬å·è§„èŒƒ

éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)ï¼š

```
MAJOR.MINOR.PATCH
ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢å·
```

| åœºæ™¯               | ç‰ˆæœ¬å˜åŒ–          |
| ------------------ | ----------------- |
| ä¸å…¼å®¹çš„ API å˜æ›´  | `1.0.0` â†’ `2.0.0` |
| å‘åå…¼å®¹çš„æ–°åŠŸèƒ½   | `1.0.0` â†’ `1.1.0` |
| å‘åå…¼å®¹çš„é—®é¢˜ä¿®å¤ | `1.0.0` â†’ `1.0.1` |

### å‘å¸ƒæµç¨‹

1. ç¡®ä¿ `main` åˆ†æ”¯ä»£ç ç¨³å®š
2. æ›´æ–° `CHANGELOG.md`
3. æ›´æ–° `package.json` ç‰ˆæœ¬å·
4. åˆ›å»º Git Tagï¼š`git tag -a v1.2.0 -m "Release v1.2.0"`
5. æ¨é€ Tagï¼š`git push origin v1.2.0`

---

> ğŸ“ **æç¤º**ï¼šè§„èŒƒçš„ç›®çš„æ˜¯æå‡æ•ˆç‡å’Œå¯ç»´æŠ¤æ€§ï¼Œè€Œéå¢åŠ è´Ÿæ‹…ã€‚åœ¨ä¿è¯åŸºæœ¬è§„èŒƒçš„å‰æä¸‹ï¼Œæ ¹æ®å®é™…æƒ…å†µçµæ´»è°ƒæ•´ã€‚
